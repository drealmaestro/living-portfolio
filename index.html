<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Living Portfolio â€” v3.3 Clean + Crypto Colors</title>
<style>
:root{
  --bg:#0b1220; --panel:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,sans-serif;font-size:15px;line-height:1.5}
.wrapper{max-width:1280px;margin:auto;padding:20px}
.header{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-bottom:16px}
.h1{font-size:22px;font-weight:700}
.sub{color:var(--muted);font-size:14px}
.row{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:16px}
.card{background:var(--panel);border:1px solid #0b2540;border-radius:14px;padding:16px;margin-bottom:14px}
.h2{font-size:16px;font-weight:600;text-transform:uppercase;color:#93c5fd;margin:8px 0 12px}
.table{width:100%;border-collapse:collapse}
.table th,.table td{font-size:14px;padding:8px;border-bottom:1px solid #0b2540}
.table th{color:#a5b4fc;font-weight:600;text-align:left}
.badge{padding:4px 10px;border-radius:999px;background:#0b1b2c;border:1px solid #1b3a5a;color:#7dd3fc;font-weight:600;font-size:13px}
.tag{padding:3px 8px;border-radius:999px;font-size:12px;margin-right:4px}
.tag.g{background:rgba(16,185,129,.15);color:#34d399;border:1px solid rgba(16,185,129,.35)}
.tag.y{background:rgba(245,158,11,.15);color:#fbbf24;border:1px solid rgba(245,158,11,.35)}
.tag.r{background:rgba(239,68,68,.15);color:#f87171;border:1px solid rgba(239,68,68,.35)}
.timeline{display:grid;gap:8px;max-height:500px;overflow:auto}
.timeline .item{display:flex;gap:12px;align-items:center;background:#0b1b2c;border:1px solid #1b3a5a;border-radius:10px;padding:10px;font-size:14px}
.flag{font-size:18px}
.small{font-size:13px;color:var(--muted)}
input[type="search"]{padding:8px 12px;border-radius:10px;background:#0b1b2c;border:1px solid #1b3a5a;color:var(--text);font-size:14px}
</style>
</head>
<body>
<div class="wrapper">

  <div class="header">
    <div>
      <div class="h1">âš¡ Living Portfolio Dashboard â€” v3.3</div>
      <div class="sub">As-of <span id="asof">â€”</span></div>
    </div>
    <input id="q" type="search" placeholder="Search tickerâ€¦"/>
  </div>

  <div class="row" id="topKPIs">
    <div class="card"><strong>Sector exposure:</strong> <span id="kpiSectors">â€”</span></div>
    <div class="card"><strong>Spec sleeve:</strong> <span id="kpiSpec">â€”</span></div>
    <div class="card"><strong>Flow snapshot:</strong> <span id="kpiFlow">â€”</span></div>
  </div>

  <div class="card">
    <div class="h2">Core Portfolio</div>
    <table class="table" id="coreTable"><thead><tr><th>Ticker</th><th>Weight</th><th>Q</th><th>Notes</th><th>Exits</th></tr></thead><tbody></tbody></table>
  </div>

  <div class="card">
    <div class="h2">Swing Plays (3â€“6M)</div>
    <table class="table" id="swingTable"><thead><tr><th>Ticker</th><th>Weight</th><th>Signal</th><th>Notes</th></tr></thead><tbody></tbody></table>
  </div>

  <div class="card">
    <div class="h2">Speculative Sleeve</div>
    <table class="table" id="specTable"><thead><tr><th>Ticker</th><th>Weight</th><th>Signal</th><th>Notes</th></tr></thead><tbody></tbody></table>
  </div>

  <div class="card">
    <div class="h2">Crypto Sleeve</div>
    <table class="table" id="cryptoTable"><thead><tr><th>Symbol</th><th>Weight</th><th>Signal</th><th>Notes</th></tr></thead><tbody></tbody></table>
  </div>

  <div class="card">
    <div class="h2">Catalyst Timeline (Next 90 Days)</div>
    <div class="timeline" id="timeline"></div>
  </div>

</div>

<script>
const ENDPOINT='https://drealmaestro.github.io/living-portfolio/live.json';
const $=sel=>document.querySelector(sel);
const $$=sel=>Array.from(document.querySelectorAll(sel));

function colorTag(sig){
  if(!sig) return '';
  const s=sig.toLowerCase();
  if(s.includes('buy')||s.includes('inflow')||s.includes('bull')) return `<span class="tag g">${sig}</span>`;
  if(s.includes('neutral')||s.includes('watch')) return `<span class="tag y">${sig}</span>`;
  if(s.includes('sell')||s.includes('outflow')||s.includes('bear')) return `<span class="tag r">${sig}</span>`;
  return sig;
}

function renderTable(tbId, rows, cols, color=false){
  const tb=$(tbId+' tbody'); tb.innerHTML='';
  rows.forEach(r=>{
    tb.innerHTML+=`<tr>${cols.map(c=>{
      let v=r[c]||''; if(color&&c==='signal') v=colorTag(v);
      return `<td>${v}</td>`;
    }).join('')}</tr>`;
  });
}
function renderTimeline(cats){
  const el=$('#timeline'); el.innerHTML='';
  (cats.company||[]).forEach(x=>{
    const flag=x.impact==='High'?'ðŸŸ¢':x.impact==='Med'?'ðŸŸ¡':'ðŸ”´';
    el.innerHTML+=`<div class="item"><span class="flag">${flag}</span><div>${x.date} â€” ${x.ticker||''} ${x.label}</div></div>`;
  });
  (cats.macro||[]).forEach(x=>{
    const flag=x.impact==='High'?'ðŸŸ¢':x.impact==='Med'?'ðŸŸ¡':'ðŸ”´';
    el.innerHTML+=`<div class="item"><span class="flag">${flag}</span><div>${x.date} â€” ${x.label}</div></div>`;
  });
}
function computeKPIs(data){
  const sectors={}; (data.core||[]).forEach(it=>{sectors[it.sector||'Other']=(sectors[it.sector||'Other']||0)+parseFloat(it.weight)||0;});
  $('#kpiSectors').textContent=Object.entries(sectors).map(([k,v])=>`${k} ${v.toFixed(0)}%`).join(' Â· ');
  const specPct=(data.spec||[]).reduce((s,x)=>s+(parseFloat(x.weight)||0),0);
  $('#kpiSpec').textContent=`${specPct.toFixed(1)}%`;
  $('#kpiFlow').textContent=data.flow?.notes||'â€”';
}
function render(data){
  $('#asof').textContent=new Date().toISOString().slice(0,16).replace('T',' ');
  renderTable('#coreTable',data.core||[],['ticker','weight','q','notes','exits']);
  renderTable('#swingTable',data.swing||[],['ticker','weight','signal','notes']);
  renderTable('#specTable',data.spec||[],['ticker','weight','signal','notes']);
  renderTable('#cryptoTable',data.crypto||[],['ticker','weight','signal','notes'],true);
  renderTimeline(data.catalysts||{company:[],macro:[]});
  computeKPIs(data);
}
async function load(){
  try{const r=await fetch(ENDPOINT+'?cb='+Date.now()); const j=await r.json(); render(j);}catch(e){console.error(e);}
}
$('#q').addEventListener('input',e=>{
  const q=e.target.value.toUpperCase();
  $$('table tbody tr,#timeline .item').forEach(el=>{
    el.style.display=el.textContent.toUpperCase().includes(q)?'':'none';
  });
});
load(); setInterval(load,180000);
</script>
</body>
</html>